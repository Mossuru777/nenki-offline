"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[447],{5447:function(t,e,n){n.r(e),n.d(e,{default:function(){return S}});var i,a,r,s,u=n(7568),o=n(4924),l=n(6042),d=n(9396),c=n(603),h=n(655),_=n(5893),f=n(7294),m=n(381),Z=n.n(m),v=n(2920),D=n(3482),y=n(5084),b=n(523),x=n(1890),p=n(6779),g=n(5398),P=n(7745),j=n(2097),k=n(1225),V=n(1953),w=n(2841),Y=n(1362),B=n(4642),A=n(6540),C=n(55),M=n(8047),N=n(1733),O=n(4099);function S(t){var e,n,m=function(t){var e,n={currentPerson:t,isNameValid:!0,isDeathDateValid:!0,isBirthDateValid:!0},i=t?{name:t.name,title:t.title,deathDate:Z()(t.death_date).format("YYYY-MM-DD"),birthDate:t.birth_date?Z()(t.birth_date).format("YYYY-MM-DD"):"",isBirthDateAccurate:null!==(e=t.is_birth_date_accurate)&&void 0!==e&&e}:{name:"",title:"",deathDate:"",birthDate:"",isBirthDateAccurate:!1};return(0,l.Z)({},n,i)},S=(0,c.Z)(f.useState((function(){return m(null)})),2),T=S[0],z=T.currentPerson,I=T.name,F=T.isNameValid,E=T.title,L=T.deathDate,G=T.isDeathDateValid,K=T.birthDate,q=T.isBirthDateValid,H=T.isBirthDateAccurate,J=S[1],Q=(0,c.Z)(f.useState(!1),2),R=Q[0],U=Q[1],W=function(){var t=(0,u.Z)((function(){var t,e,n;return(0,h.__generator)(this,(function(i){return t=I.length>0,e=L.length>0,n=0===L.length||0===K.length||new Date(K)<=new Date(L),J((function(i){return(0,d.Z)((0,l.Z)({},i),{isNameValid:t,isDeathDateValid:e,isBirthDateValid:n})})),t&&e&&n?[2,Promise.resolve()]:[2,Promise.reject({isNameValid:t,isDeathDateValid:e,isBirthDateValid:n})]}))}));return function(){return t.apply(this,arguments)}}(),X=function(t){var e=t.target,n=e.name,u=e.value,c={isNameValid:F,isDeathDateValid:G,isBirthDateValid:q,isBirthDateAccurate:H};"name"===n?(i=c).isNameValid||(i.isNameValid=u.length>0):"deathDate"===n?u.length>0?(a=c).isDeathDateValid||(a.isDeathDateValid=!0):(r=c).isBirthDateValid||(r.isBirthDateValid=!0):"birthDate"===n&&((s=c).isBirthDateValid||(s.isBirthDateValid=0===u.length||new Date(u)<=new Date(L))),J((function(t){return(0,l.Z)((0,d.Z)((0,l.Z)({},t),(0,o.Z)({},n,u)),c)}))},$=function(){var e=(0,u.Z)((function(){var e,n,i,a;return(0,h.__generator)(this,(function(r){return F&&G&&q?(e=Z().tz(L,"YYYY-MM-DD",!0,"Asia/Tokyo"),n=""!==K?Z().tz(K,"YYYY-MM-DD",!0,"Asia/Tokyo"):null,i=null!==n?H:null,t.editPerson?(t.editPerson.name=I,t.editPerson.title=E,t.editPerson.death_date=e,t.editPerson.birth_date=n,t.editPerson.is_birth_date_accurate=i,[2,D.Z.instance.updatePerson(t.editPerson)]):(a=new v.Z(null,I,E,e,n,i),[2,D.Z.instance.addPerson(a)])):[2,Promise.reject({isNameValid:F,isDeathDateValid:G,isBirthDateValid:q})]}))}));return function(){return e.apply(this,arguments)}}(),tt=function(){W().then((function(){return U(!0)})).then($).then(t.closeDialog).catch((function(t){})).finally((function(){return U(!1)}))},et=(0,j.Z)(),nt=(0,k.Z)(et.breakpoints.down("sm")),it=void 0!==z,at=(0,c.Z)(f.useState(!1),2),rt=at[0],st=at[1];return z!==t.editPerson&&J((function(){return m(t.editPerson)})),(0,_.jsxs)(V.Z,{children:[(0,_.jsxs)(x.Z,{fullScreen:nt,open:it,children:[(0,_.jsx)(P.Z,{children:"\u4eba\u7269\u306e\u8ffd\u52a0"}),(0,_.jsxs)(g.Z,{sx:{"& .MuiTextField-root":{m:2}},children:[(0,_.jsxs)(V.Z,{sx:{display:"flex"},children:[(0,_.jsx)(b.Z,{autoFocus:!0,label:"\u540d\u524d",name:"name",value:I,error:!F,helperText:F?null:"\u540d\u524d\u3092\u5165\u529b\u3057\u3066\u4e0b\u3055\u3044",onChange:X,variant:"standard",inputProps:{size:30}}),(0,_.jsx)(b.Z,{label:"\u656c\u79f0",name:"title",value:E,onChange:X,variant:"standard",inputProps:{size:8}})]}),(0,_.jsx)(V.Z,{children:(0,_.jsx)(b.Z,{label:"\u547d\u65e5",type:"date",name:"deathDate",value:L,error:!G,helperText:G?null:"\u547d\u65e5\u3092\u5165\u529b\u3057\u3066\u4e0b\u3055\u3044",onChange:X,variant:"standard",sx:{width:220},InputLabelProps:{shrink:!0}})}),(0,_.jsxs)(V.Z,{sx:{display:"flex"},children:[(0,_.jsx)(b.Z,{label:"\u751f\u5e74\u6708\u65e5",type:"date",name:"birthDate",value:K,error:!q,helperText:q?null:"\u547d\u65e5\u3088\u308a\u524d\u306e\u65e5\u4ed8\u3092\u5165\u529b\u3057\u3066\u4e0b\u3055\u3044",onChange:X,variant:"standard",sx:{width:220},InputLabelProps:{shrink:!0}}),(0,_.jsx)(w.Z,{control:(0,_.jsx)(Y.Z,{name:"isBirthDateAccurate",checked:H,onChange:function(t){var e=t.target.name,n=t.target.checked;J((function(t){return(0,d.Z)((0,l.Z)({},t),(0,o.Z)({},e,n))}))},color:"primary"}),label:"\u751f\u5e74\u6708\u65e5\u306f\u6b63\u78ba\u3067\u3059"})]})]}),(0,_.jsxs)(p.Z,{children:[t.editPerson?(0,_.jsx)(O.Z,{color:"error",disabled:R,onClick:function(){t.editPerson&&st(!0)},children:(0,_.jsx)(N.Z,{})}):null,(0,_.jsx)("div",{style:{flexGrow:1}}),(0,_.jsx)(y.Z,{variant:"outlined",color:"error",disabled:R,startIcon:(0,_.jsx)(M.Z,{}),onClick:t.closeDialog,children:"\u30ad\u30e3\u30f3\u30bb\u30eb"}),t.editPerson?(0,_.jsx)(O.Z,{variant:"contained",loading:R,disabled:R,startIcon:(0,_.jsx)(C.Z,{}),onClick:tt,children:"\u66f4\u65b0"}):(0,_.jsx)(O.Z,{variant:"contained",loading:R,disabled:R,startIcon:(0,_.jsx)(A.Z,{}),onClick:tt,children:"\u8ffd\u52a0"})]})]}),(0,_.jsxs)(x.Z,{open:rt,children:[(0,_.jsx)(P.Z,{children:"\u78ba\u8a8d"}),(0,_.jsx)(g.Z,{children:(0,_.jsxs)(B.Z,{children:[null===(e=t.editPerson)||void 0===e?void 0:e.name,null===(n=t.editPerson)||void 0===n?void 0:n.title," \u306e\u30c7\u30fc\u30bf\u3092\u524a\u9664\u3057\u307e\u3059\u304c\u3001\u3088\u308d\u3057\u3044\u3067\u3059\u304b?"]})}),(0,_.jsxs)(p.Z,{children:[(0,_.jsx)(y.Z,{onClick:function(){return st(!1)},children:"\u30ad\u30e3\u30f3\u30bb\u30eb"}),(0,_.jsx)(y.Z,{color:"error",onClick:function(){st(!1),t.editPerson&&(U(!0),D.Z.instance.deletePerson(t.editPerson).then(t.closeDialog).catch((function(t){})).finally((function(){return U(!1)})))},autoFocus:!0,children:"OK"})]})]})]})}},3482:function(t,e,n){n.d(e,{Z:function(){return h}});var i=n(7568),a=n(1438),r=n(8029),s=n(6567),u=n(655),o=n(9520),l=n(8),d=n.n(l),c=n(2920),h=function(t){(0,r.Z)(n,t);var e=(0,s.Z)(n);function n(){var t;return(0,a.Z)(this,n),(t=e.call(this,"PersonDB")).version(1).stores({persons:"++id, name, title, death_date_unixtime, birth_date_unixtime, is_birth_date_accurate"}),t}var o=n.prototype;return o.addPerson=function(t){var e=this;return(0,i.Z)((function(){var n,i,a;return(0,u.__generator)(this,(function(r){return a={name:t.name,title:t.title,death_date_unixtime:t.death_date.valueOf(),birth_date_unixtime:null!==(i=null===(n=t.birth_date)||void 0===n?void 0:n.valueOf())&&void 0!==i?i:null,is_birth_date_accurate:t.is_birth_date_accurate},[2,e.persons.add(a)]}))}))()},o.updatePerson=function(t){var e=this;return(0,i.Z)((function(){var n,i;return(0,u.__generator)(this,(function(a){return[2,e.persons.update(t.db_id,{name:t.name,title:t.title,death_date_unixtime:t.death_date.valueOf(),birth_date_unixtime:null!==(i=null===(n=t.birth_date)||void 0===n?void 0:n.valueOf())&&void 0!==i?i:null,is_birth_date_accurate:t.is_birth_date_accurate})]}))}))()},o.deletePerson=function(t){var e=this;return(0,i.Z)((function(){return(0,u.__generator)(this,(function(n){return null===t.db_id?[2,Promise.reject("Person has no db_id.")]:[2,e.persons.delete(t.db_id)]}))}))()},o.getAllPersons=function(){var t=this;return(0,i.Z)((function(){return(0,u.__generator)(this,(function(e){return[2,t.persons.toArray().then((function(t){var e;return t.map((function(t){return new c.Z(null!==(e=t.id)&&void 0!==e?e:null,t.name,t.title,d()(t.death_date_unixtime),t.birth_date_unixtime?d()(t.birth_date_unixtime):null,t.is_birth_date_accurate)}))}))]}))}))()},n}(o.default);h.instance=new h},2920:function(t,e,n){n.d(e,{Z:function(){return f}});var i=n(1438),a=n(2951),r=n(8),s=n.n(r),u=n(7596),o=n.n(u),l=n(2037),d=function t(e,n){(0,i.Z)(this,t);var a=e.asYears(),r=e.asDays(),u=(0,l.Z)(t,t,c).find((function(t){return t[0].asDays()-r===0}));o()(a>=1||void 0!==u,"\u4e0d\u6b63\u306aduration"),this.date=s()(n.death_date),this.date.add(e);var d=function(){if(0===r)return"";var t="\n\u4ea1\u304f\u306a\u3063\u3066\u304b\u3089";return t+=r<=100?"".concat(r+1,"\u65e5\u76ee"):"".concat(a,"\u5e74\u304c\u7d4c\u904e")};void 0!==u?(this.title=u!==(0,l.Z)(t,t,c)[0]?u[1]:null,this.summary="".concat(n.name).concat(n.title," ").concat(u[1]),this.description="".concat(this.summary),0===r?(null!==n.gyounen&&(this.summary+=" (\u884c\u5e74 ".concat(n.gyounen,"\u6b73)")),null!==n.birth_date&&(this.description+="\n".concat(n.birth_date.format("YYYY\u5e74M\u6708D\u65e5 \u751f"))),null!==n.gyounen&&(this.description+="\n\u884c\u5e74 ".concat(n.gyounen,"\u6b73")),null!==n.kyounen&&(this.description+="\n\u4eab\u5e74 ".concat(n.kyounen,"\u6b73"))):this.description+=d()):(this.title=null,this.summary="".concat(n.name).concat(n.title," \u547d\u65e5"),this.description="".concat(this.summary).concat(d()))},c={writable:!0,value:[[s().duration(0),"\u6ca1"],[s().duration(6,"days"),"\u521d\u4e03\u65e5\u6cd5\u8981"],[s().duration(48,"days"),"\u56db\u5341\u4e5d\u65e5\u6cd5\u8981"],[s().duration(99,"days"),"\u767e\u30f6\u65e5\u6cd5\u8981"],[s().duration(1,"years"),"\u4e00\u5468\u5fcc\u6cd5\u8981"],[s().duration(2,"years"),"\u4e09\u56de\u5fcc\u6cd5\u8981"],[s().duration(6,"years"),"\u4e03\u56de\u5fcc\u6cd5\u8981"],[s().duration(12,"years"),"\u5341\u4e09\u56de\u5fcc\u6cd5\u8981"],[s().duration(16,"years"),"\u5341\u4e03\u56de\u5fcc\u6cd5\u8981"],[s().duration(22,"years"),"\u4e8c\u5341\u4e09\u56de\u5fcc\u6cd5\u8981"],[s().duration(24,"years"),"\u4e8c\u5341\u4e94\u56de\u5fcc\u6cd5\u8981"],[s().duration(26,"years"),"\u4e8c\u5341\u4e03\u56de\u5fcc\u6cd5\u8981"],[s().duration(32,"years"),"\u4e09\u5341\u4e09\u56de\u5fcc\u6cd5\u8981"],[s().duration(36,"years"),"\u4e09\u5341\u4e03\u56de\u5fcc\u6cd5\u8981"],[s().duration(42,"years"),"\u56db\u5341\u4e09\u56de\u5fcc\u6cd5\u8981"],[s().duration(46,"years"),"\u56db\u5341\u4e03\u56de\u5fcc\u6cd5\u8981"],[s().duration(49,"years"),"\u4e94\u5341\u56de\u5fcc\u6cd5\u8981"]]},h=function t(e){(0,i.Z)(this,t);for(var n,a,r=[new d(s().duration(0),e),new d(s().duration(48,"days"),e),new d(s().duration(99,"days"),e)],u=1;u<=49;u++)r.push(new d(s().duration(u,"years"),e));this.nenki_array=Object.freeze(Array.from(r)),this.next_nenki=null!==(n=r.find((function(e){return null!==e.title&&e.date.isSameOrAfter((0,l.Z)(t,t,_))})))&&void 0!==n?n:null,this.last_nenki=null!==(a=r.reverse().find((function(e){return null!==e.title&&e.date.isBefore((0,l.Z)(t,t,_))})))&&void 0!==a?a:null},_={writable:!0,value:s().tz("Asia/Tokyo")},f=function(){function t(e,n,a,r,u,l){var d=this;(0,i.Z)(this,t),o()(null!==u||null===l,"If birth_date is null, is_birth_date_accurate must be set null."),this.db_id=e,this.name=n,this.title=a,this._death_date=r,this.gyounen=null!==u?r.diff(u,"years"):null,this.kyounen=function(){if(null===d.gyounen)return null;var t=d.gyounen;if(u.month()>0||u.date()>1){t+=1;var e=r.diff(u,"years"),n=s()(u).add(e,"years");r.isSameOrAfter(n)||(t+=1)}return t}(),this.birth_date=u,this.is_birth_date_accurate=null!==u?l:null,this._nenki_list=new h(this)}return(0,a.Z)(t,[{key:"death_date",get:function(){return this._death_date},set:function(t){t.isSame(this._death_date)||(this._death_date=s()(t),this._nenki_list=new h(this))}},{key:"nenki_list",get:function(){return this._nenki_list}}]),t}()}}]);